<div xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd">
    <nav class="navbar navbar-inverse navbar-fixed-top header">

        <div class="container">
            <a class="logo" href="/"><img src="${contextPath}/img/logo.png" alt="logo"/></a>
            <t:if test="header">
                <div class="pull-right">
                    <t:if test="cook">
                        <t:pagelink class="header-block pic-holder orders" page="office/orders">
                            <span/>
                            Заказы
                        </t:pagelink>
                    </t:if>
                    <t:if test="showBonuses">
                        <a href="#bonus" data-toggle="modal" data-target="#bonus">${bonusesMessage}</a>
                    </t:if>
                    <t:if test="authenticated">
                        <span class="header-block pic-holder dropdown username">
                            <a data-target="#" href="#userMenu" data-toggle="dropdown" aria-haspopup="true" role="button" aria-expanded="false">
                                <img class="avatar-small" src="${authenticatedUser.avatarUrlSmall}"/>
                                ${authenticatedUser.printableName}
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <t:pagelink page="office/index" context="['UPDATE','0']">Мой профиль</t:pagelink>
                                </li>
                                <t:if test="user">
                                    <li>
                                        <t:pagelink page="office/orders">Мои заказы</t:pagelink>
                                    </li>
                                </t:if>
                                <t:if test="cook">
                                    <t:loop source="catalogs" value="oneCatalog">
                                        <li>
                                            <t:pagelink page="catalog/index" t:context="oneCatalog.id">Каталог '${oneCatalog.name}'</t:pagelink>
                                        </li>
                                    </t:loop>
                                    <li>
                                        <t:pagelink page="cook/bills">Счета</t:pagelink>
                                    </li>
                                </t:if>
                                <t:if test="admin">
                                    <li>
                                        <t:pagelink page="admin/order/list">Все заказы</t:pagelink>
                                    </li>
                                    <li>
                                        <t:pagelink page="cook/bills">Все счета</t:pagelink>
                                    </li>
                                    <li>
                                        <t:pagelink page="admin/category/list">Системные настройки</t:pagelink>
                                    </li>
                                </t:if>
                                <li><a href="/logout">Выход</a></li>
                            </ul>
                        </span>
                    </t:if>
                    <t:unless test="authenticated">
                        <a href="#login" data-toggle="modal" class="header-block pic-holder login-link" data-target="#login"><span/>Войти или зарегистрироваться</a>
                    </t:unless>
                    <t:zone elementName="span" t:id="basketZone" class="header-block ${hidden}">
                        <t:unless test="cook">
                            <t:delegate to="basketBlock"/>
                        </t:unless>
                    </t:zone>
                </div>
            </t:if>

        </div>

    </nav>

    <t:block t:id="basketBlock">
        <t:pagelink class="pic-holder basket" page="cart">
            <span/>
            <t:if test="shoppingCart.products.size()">
                ${shoppingCart.products.size()} ${declProducts}
                <t:parameter name="else">
                    <t:pagelink page="cart">
                        В корзине пусто
                    </t:pagelink>
                </t:parameter>
            </t:if>
        </t:pagelink>
        <t:if test="shoppingCart.justAdded">
            <div class="dropdown-menu basket-show">
                Товар добавлен в корзину. <br/>Вы можете продолжить поиск или перейти
                <t:pagelink page="cart">к оформлению заказа</t:pagelink>
            </div>
        </t:if>
    </t:block>

    <t:unless test="authenticated">
        <t:loginUserModal/>
    </t:unless>

    <t:if test="showBonuses">
        <div class="modal fade" id="bonus" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog bonus">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="title">
                            <h1><span>Бонусные баллы</span></h1>
                        </div>
                        <a class="modal-close" data-dismiss="modal"></a>
                    </div>
                    <div class="modal-body">
                        <t:if test="authenticated">
                            <p class="modal-text f20px">Сейчас на Вашем счету ${bonusesMessage.toLowerCase()}</p>
                        </t:if>
                        <p class="modal-text">Каждый раз когда Вы совершаете покупку на ГастроМаркет, мы возвращаем Вам 3 процента от стоимости заказа в виде бонусных баллов.</p>

                        <p class="modal-text">Вы можете расплатиться баллами при размещении новых заказов.</p>

                        <p class="modal-text">
                            <a href="/userinfo" class="red-link">узнать подробности</a>
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </t:if>


</div>