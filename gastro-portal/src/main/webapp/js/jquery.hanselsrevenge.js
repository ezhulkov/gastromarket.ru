function BreadCrumbTrail(t){var e={breadCrumbSelector:"",maxDepth:5,ellipsisLongCrumbs:!1,inheritLandingCrumbs:!0,allowURIQuery:!1,cookieOptions:{path:"/"},debug:!1,titleCallback:null};this.options=jQuery.extend(e,t),this.trail=[],this.links={},this.push=function(t){if(this.links[t.link]){this.rewindToUrl(t.link);for(var e=0;e<this.trail.length;e++)this.trail[e].link===getRelativeUrl(document.location.href)&&(this.trail[e].text=t.text)}else this.trail.push(t);this.links[t.link]=t.text,this.trail.length>3},this.pop=function(){var t=this.trail.pop();return this.links[t.link]=void 0,t},this.init=function(t){this.trail=t;for(var e=0;e<t.length;e++)this.links[t[e].link]=t[e].text},this.rewindToUrl=function(t){for(var e=this.trail.length-1;e>=0&&this.trail[e].link!=t;e--);this.trail=0===e?[this.trail[0]]:this.trail.slice(0,e+1)}}jQuery.extend(jQuery.fn,{hasParent:function(t){return jQuery(t).find(this).length>0}});var getRelativeUrl=function(t){var e=/https?:\/\/.*?(\/.*?)($|\?|#)/,i=e.exec(t);return i?i[1]:"/"},getTitle=function(t){var e;if(document.title){var i=jQuery("<title>").text(document.title);e=i.get(0).innerHTML}else{var n=document.location.pathname;"/"===n[n.length-1]&&(n=n.substring(0,n.length-1)),e=n.split("/").pop()}return t.ellipsisLongCrumbs&&e.length>30&&(e=e.substring(0,30)+"..."),e};!function(t){t.fn.hanselsRevenge=function(e){var i=new BreadCrumbTrail(e),n=e&&e.cookieKey?e.cookieKey:"hanselsrevenge";if(this.selector)var r=this;else var r=t(e.breadCrumbSelector);e=i.options,e.minWidthHide&&(window.onresize=function(){var i=t(document).width(),n=parseInt(e.minWidthHide);n||console.error("Couldn't parse minWidthHide"),n>=i?r.hide():r.show()});var l=function(t){e.debug&&"undefined"!=typeof console&&console.log&&console.log(t)};e.debug&&r.length<1&&l("No breadcrumbs found for: "+e.breadCrumbSelector);var o=function(t){var e=/(https?:\/\/.*?)(\/|$)/,i=e.exec(t);return i&&i.length>0?i[1]:""};t("a").click(function(){this.href&&(o(this.href)!==document.location.protocol+"//"+document.location.host||t(this).hasParent(e.resetContainer)||void 0!==e.resetPattern?this.href.match(e.resetPattern):!1)&&(l("clearing breadcrumb trail"),t.removeCookie(n,e.cookieOptions))});var a=t.cookie(n);if(a)try{i.init(JSON.parse(a))}catch(s){i.init([])}else if(e.inheritLandingCrumbs){t("a",r).each(function(){i.push({link:getRelativeUrl(this.href),text:this.innerHTML})});var h=t("a:last-child",r);h&&h[0]&&i.push({link:document.location.pathname,text:h[0].innerHTML})}else i.init(e.defaultTrail||[]);path=document.location.pathname,e.allowURIQuery&&(path+=document.location.search+document.location.hash);var c=getTitle;if("function"==typeof i.options.titleCallback&&(c=i.options.titleCallback),i.push({link:path,text:c(e)}),i.trail.length>0&&(t.cookie(n,JSON.stringify(i.trail),e.cookieOptions),r.length>0)){r.html("");for(var u=i.trail.length>e.maxDepth?e.maxDepth:i.trail.length,d=0,p=u-1;p>=0;p--){var f=i.trail.pop();f.text=i.links[f.link];var g=t("<li><a href='"+f.link+"'>"+f.text+"</a></li>");r.prepend(g),d+=g.width(),r.parent().width()}}}}(jQuery);